# 修复下载文件被保存为隐藏文件的问题

## 问题分析

1. **现象**：点击下载按钮后，文件被保存为隐藏文件（文件名可能以点开头）
2. **根本原因**：

   * `rootFolderName` 直接使用 `parsedResult.title`，如果标题为空或包含特殊字符，可能导致文件名问题

   * 没有检查最终生成的 ZIP 文件名是否以点开头

   * 缺少对文件名的验证和清理

## 修复方案

**文件**：`/Users/wangxuyang/Downloads/01_GitHub/demo/videoAll/frontend/src/pages/ContentParsing.jsx`
**修改点**：

1. **增强文件名验证**：

   * 检查最终生成的 ZIP 文件名是否以点开头

   * 如果文件名以点开头，添加默认前缀或使用安全的默认名称

2. **清理文件名**：

   * 移除或替换文件名中的特殊字符

   * 确保文件名在各种操作系统中都有效

3. **优化默认命名**：

   * 为文件名提供更可靠的默认值

   * 确保默认文件名不会被视为隐藏文件

## 实现步骤

1. **修改** **`handleDownload`** **函数**：

   * 添加文件名清理和验证逻辑

   * 确保最终生成的 ZIP 文件名不以点开头

   * 优化文件名生成规则

2. **添加辅助函数**：

   * 创建 `sanitizeFileName` 函数，用于清理和验证文件名

   * 确保文件名符合操作系统命名规范

3. **测试修复**：

   * 测试各种标题情况下的文件名生成

   * 确保生成的文件名都是可见文件

   * 验证下载功能正常工作

## 预期效果

1. 无论内容标题如何，下载的文件都是可见文件
2. 文件名符合操作系统命名规范
3. 特殊字符被正确处理
4. 下载功能保持正常工作

## 技术要点

* 文件名不得以点开头（避免被视为隐藏文件）

* 移除或替换文件名中的非法字符

* 提供可靠的默认文件名

* 确保跨操作系统兼容性

